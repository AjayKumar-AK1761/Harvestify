<!DOCTYPE html>
<html lang="en">

<head>
	<title>{{ title }}</title>
	<link rel="shortcut icon" href="{{ url_for('static', filename='images/favicon.ico') }}" />

	<!-- for-mobile-apps -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">
	<meta name="keywords" content="Agro Harvest Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template, 
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />

	<style>
		html {
			font-size: 1rem;
		}

		@media (min-width: 576px) {
			html {
				font-size: 1.25rem;
			}
		}

		@media (min-width: 768px) {
			html {
				font-size: 1.5rem;
			}
		}

		@media (min-width: 992px) {
			html {
				font-size: 1.75rem;
			}
		}

		@media (min-width: 1200px) {
			html {
				font-size: 1rem;
			}

			h1 {
				font-size: 1.2rem;
			}

			h2 {
				font-size: 1.1rem;
			}

			@media (min-width: 768px) {
				html {
					font-size: 1.1rem;
				}

				h1 {
					font-size: 1.3rem;
				}

				h2 {
					font-size: 1.2rem;
				}
			}

			@media (min-width: 991px) {
				html {
					font-size: 1.2rem;
				}

				h1 {
					font-size: 1.5rem;
				}

				h2 {
					font-size: 1.4rem;
				}
			}

			@media (min-width: 1200px) {
				html {
					font-size: 1.2rem;
				}

				h1 {
					font-size: 1.7rem;
				}

				h2 {
					font-size: 1.6rem;
				}
			}
		}

		#chatbot-toggle {
			position: fixed;
			bottom: 20px;
			right: 20px;
			background-color: #007BFF;
			color: white;
			font-size: 1.5rem;
			border-radius: 50%;
			width: 60px;
			height: 60px;
			text-align: center;
			line-height: 60px;
			cursor: pointer;
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
			z-index: 9999;
		}

		#chatbot-container {
			position: fixed;
			bottom: 90px;
			right: 20px;
			width: 350px;
			max-height: 500px;
			z-index: 9999;
		}

		.chat-container {
			background: white;
			border-radius: 10px;
			box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
			display: flex;
			flex-direction: column;
			height: 100%;
		}

		.chat-box {
			height: 300px;
			overflow-y: auto;
			padding: 15px;
			display: flex;
			flex-direction: column;
		}

		.message {
			margin: 10px 0;
			padding: 10px 15px;
			border-radius: 20px;
			max-width: 75%;
			word-wrap: break-word;
		}

		.bot {
			background: #e0e0e0;
			align-self: flex-start;
		}

		.user {
			background: #007BFF;
			color: white;
			align-self: flex-end;
		}

		.input-box {
			display: flex;
			padding: 10px;
			border-top: 1px solid #ccc;
		}

		.input-box input {
			flex: 1;
			padding: 10px;
			border-radius: 20px;
			border: 1px solid #ccc;
			margin-right: 10px;
		}

		.input-box button {
			padding: 10px 15px;
			border: none;
			background: #007BFF;
			color: white;
			border-radius: 20px;
			cursor: pointer;
		}
	</style>

	<script>
		addEventListener("load", function () {
			setTimeout(hideURLbar, 0);
		}, false);

		function hideURLbar() {
			window.scrollTo(0, 1);
		}
	</script>

	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
		integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
		crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
		integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
		crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
		integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
		crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
		integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
		integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
		crossorigin="anonymous"></script>
	</body>
	<!-- css files -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
		integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link href="{{ url_for('static', filename='css/bootstrap.css') }}" rel='stylesheet' type='text/css' />
	<!-- bootstrap css -->
	<link href="{{ url_for('static', filename='css/style.css') }}" rel='stylesheet' type='text/css' />
	<!-- custom css -->
	<link href="{{ url_for('static', filename='css/font-awesome.min.css') }}" rel="stylesheet"><!-- fontawesome css -->
	<!-- //css files -->
	<!-- <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/favicon.png?') }}"> -->


	<script type="text/JavaScript" src="{{ url_for('static', filename='scripts/cities.js') }}"></script>


	<!-- google fonts -->
	<link href="//fonts.googleapis.com/css?family=Thasadith:400,400i,700,700i&amp;subset=latin-ext,thai,vietnamese"
		rel="stylesheet">
	<!-- //google fonts -->

	<style>
		header {
			background-color: rgba(30, 30, 30, 1);
			margin-top: 0rem;
			display: block;

		}
	</style>
</head>

<body>

	<!-- Navigation -->
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark static-top" style="background-color: #1C00ff00;">
		<div class="container">
			<a class="navbar-brand" href="{{ url_for('home') }}">
				<img src="{{ url_for('static', filename='images/logo.jpg') }}" style="width: 90px; height: 55px" alt="">
			</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive"
				aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarResponsive">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item active">
						<a class="nav-link" href="{{ url_for('home') }}">Home
							<span class="sr-only">(current)</span>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="{{ url_for('crop_recommend') }}">Crop</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="{{ url_for('fertilizer_recommendation') }}">Fertilizer</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="{{ url_for('disease_prediction') }}">Disease</a>
					</li>
				</ul>
			</div>
		</div>
	</nav>




	{% block body %} {% endblock %}

	<!-- footer -->
	<footer class="text-center py-5">
		<div class="container py-md-3">
			<!-- logo -->
			<h2 class="logo2 text-center">
				<a href="{{ url_for('home') }}">
					Harvestify
				</a>
			</h2>
			<!-- //logo -->
			<!-- address -->
			<div class="contact-left-footer mt-4">


				<!-- <a href="community.html">Community</a> -->
				</p>
			</div>
			<div class="w3l-copy text-center">
				<p class="text-da">An Agricultural Intelligence Project<br> </p>
			</div>
			<div class="homelogo">
				<p>Made with ‚ù§Ô∏è by a team of final-year Computer Science Engineering students from KVG College of
					Engineering</p>
				<p>&copy; Copyright 2025 Team Harvestify</p>
			</div>
		</div>
	</footer>
	<!-- //footer -->

	<!-- move top icon -->
	<a href="#home" class="move-top text-center"></a>
	<!-- //move top icon -->

	<!-- Floating Chatbot Button -->
	<div id="chatbot-toggle" onclick="toggleChatbot()">üí¨</div>

	<!-- Chatbot Interface -->
	<div id="chatbot-container" style="display: none;">
		<div class="chat-container">
			<div class="chat-box" id="chat">
				<!-- Intro Messages -->
				<div class="message bot">Hi there! I‚Äôm AgriBot.</div>
				<div class="message bot">I can recommend crops based on your local conditions.</div>
				<div class="message bot">Type <strong>'start'</strong> to begin the recommendation process.</div>
			</div>

			<form id="chat-form" class="input-box">
				<input type="text" id="userInput" placeholder="Type your message..." autocomplete="off" />
				<button type="submit">Send</button>
			</form>
		</div>
	</div>

	<script>
		function toggleChatbot() {
			const container = document.getElementById('chatbot-container');
			container.style.display = (container.style.display === 'none' || container.style.display === '') ? 'block' : 'none';
		}

		const chatBox = document.getElementById("chat");
		const userInput = document.getElementById("userInput");

		function addMessage(sender, text) {
			const msg = document.createElement("div");
			msg.className = `message ${sender}`;
			msg.innerText = text;
			chatBox.appendChild(msg);
			chatBox.scrollTop = chatBox.scrollHeight;
		}

		function botReply(text) {
			addMessage("bot", text);
		}

		document.getElementById("chat-form").addEventListener("submit", async function (e) {
			e.preventDefault();
			const text = userInput.value.trim();
			if (!text) return;

			addMessage("user", text);
			userInput.value = "";

			if (/^\d/.test(text)) {
				try {
					const response = await fetch("/recommend", {
						method: "POST",
						headers: { "Content-Type": "application/json" },
						body: JSON.stringify({ input: text })
					});

					const data = await response.json();
					if (response.ok) {
						botReply(data.message);
					} else {
						botReply(`Input Error: ${data.message}`);
					}
				} catch (err) {
					botReply("Server error: Could not connect to the recommendation API.");
				}
			} else {
				const lower = text.toLowerCase();
				if (["hi", "hello", "hey"].includes(lower)) {
					botReply("Hi! To get a crop recommendation, please type your values as: N,P,K,temperature,humidity,pH,rainfall");
				} else if (lower === "start") {
					botReply("Please provide your values in the format: N,P,K,temp,humidity,ph,rainfall");
				} else {
					botReply("Sorry, I didn't understand that. Please enter valid crop input values or say 'hi'.");
				}
			}
		});
	</script>


</body>

</html>